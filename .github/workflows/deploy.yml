name: Deploy

on:
  push:
    branches: [ master ]
    paths-ignore: 
      - README.md

jobs:
  build:
    runs-on: ubuntu-latest
    steps:

    - uses: actions/checkout@v2
    - uses: actions/checkout@v2
      with:
        repository: UM-LPM/known_hosts 
        path: machines/known_hosts
    - uses: cachix/install-nix-action@v7

    # Runs a single command using the runners shell
    - name: Deploy
      run: |
        eval "$(ssh-agent)"
        ssh-add - <<< "${{secrets.sshkey}}"
        cd machines
        ./deploy.sh
